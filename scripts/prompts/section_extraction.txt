You are extracting ALL structured content from Chapter {chapter_number}: {chapter_title} of this Kaplan MCAT textbook.
This chapter contains these sections: {section_list}

═══════════════════════════════════════════════════════════════
EXTRACT FOR EACH SECTION (e.g., 1.1, 1.2, etc.)
═══════════════════════════════════════════════════════════════

A. LEARNING OBJECTIVES
   Found at the very start of each section. They typically begin with "After this lesson, you will be able to:" or "Learning Objectives:". Extract as a list of strings.

B. CONTENT — as TYPED CONTENT BLOCKS
   Go through the section and categorize each piece of content:

   - "text": Running paragraph text. Extract verbatim.
   - "bullet_list": Bulleted or dashed items. Extract as an array of strings.
   - "numbered_steps": Ordered process steps. Extract as array of objects with step number and text.
   - "comparison_table": Table comparing 2+ things. Extract headers and all rows.
   - "fill_in_table": A table used as a concept check where some cells are blanks the student fills in. Extract the COMPLETE table with all answers filled in. Mark which column was originally blank.
   - "figure_reference": A reference to a figure/diagram (e.g., "See Figure 1.9"). Record the figure_id, caption, and a brief description of what context it appears in.
   - "definition": A term with its explicit definition (often bolded terms). Extract the term and its definition.

C. CONCEPT SUMMARY (end of chapter, organized by section)
   Extract the section-by-section summary bullet points verbatim.

D. CONCEPT CHECK QUESTIONS + ANSWER KEY
   Extract EVERY end-of-chapter review question with:
   - Question number and full text
   - All answer options (if multiple choice)
   - The correct answer from the answer key
   - The full explanation from the answer key
   - Which section it tests
   Note: Some concept checks are fill-in-table format. Extract both the question format and the completed answer.

E. CALLOUTS: MNEMONICS, MCAT EXPERTISE, AND OTHER CALLOUTS
   Extract ALL boxed/highlighted callouts with:
   - The exact text
   - The type: "mnemonic" | "mcat_expertise" | "bridge_note" | "real_world" | "key_concept" | "high_yield"
   - Which section it appears in
   - Brief context of what topic it relates to

F. EQUATIONS TO REMEMBER (if present in this chapter)
   Extract with: equation_id (e.g., "2.1"), title, equation in plain text, and each variable with its meaning and unit.

G. SHARED CONCEPTS (if present at end of this chapter)
   Extract each cross-reference exactly as written:
   - External subject/book name
   - External chapter number and title
   - The specific topic(s) mentioned on the line below

OUTPUT (strict JSON):

{{
  "book": "{book_subject}",
  "chapter_number": {chapter_number},
  "chapter_title": "{chapter_title}",

  "sections": [
    {{
      "section_id": "1.1",
      "section_title": "Section Title",
      "is_high_yield": true,

      "learning_objectives": [
        "Describe the three tenets of cell theory",
        "Distinguish between prokaryotic and eukaryotic cells"
      ],

      "content_blocks": [
        {{
          "format": "text",
          "content": "The cell theory was first proposed..."
        }},
        {{
          "format": "bullet_list",
          "content": ["Item one", "Item two", "Item three"]
        }},
        {{
          "format": "numbered_steps",
          "title": "Steps of Binary Fission",
          "content": [
            {{"step": 1, "text": "DNA replication begins at the origin"}},
            {{"step": 2, "text": "Cell elongates, pushing copies apart"}}
          ]
        }},
        {{
          "format": "comparison_table",
          "title": "Prokaryotic vs Eukaryotic Cells",
          "headers": ["Feature", "Prokaryotic", "Eukaryotic"],
          "rows": [
            ["Nucleus", "No (nucleoid region)", "Yes (membrane-bound)"],
            ["Organelles", "None membrane-bound", "Multiple membrane-bound"]
          ]
        }},
        {{
          "format": "fill_in_table",
          "title": "Organelle Functions",
          "headers": ["Organelle", "Function"],
          "given_column": "Organelle",
          "blank_column": "Function",
          "rows": [
            {{"given": "Mitochondria", "answer": "Aerobic respiration and ATP production"}},
            {{"given": "Rough ER", "answer": "Protein synthesis and modification"}}
          ]
        }},
        {{
          "format": "figure_reference",
          "figure_id": "1.3",
          "caption": "Prokaryotic Cell Structure",
          "context": "Illustrates the discussion of cell membrane and cell wall"
        }},
        {{
          "format": "definition",
          "term": "Endosymbiotic theory",
          "definition": "The theory that mitochondria and chloroplasts evolved from free-living prokaryotes."
        }}
      ],

      "callouts": [
        {{
          "type": "mnemonic",
          "text": "F-POT: Frontal, Parietal, Occipital, Temporal",
          "related_content": "Brain lobe names"
        }},
        {{
          "type": "mcat_expertise",
          "text": "The MCAT often presents enzyme inhibition as experimental scenarios...",
          "related_content": "Enzyme inhibition types"
        }}
      ]
    }}
  ],

  "summary": {{
    "by_section": [
      {{
        "section_id": "1.1",
        "section_title": "Cell Theory",
        "summary_points": [
          "All living things are composed of cells",
          "The cell is the basic functional unit of life"
        ]
      }}
    ]
  }},

  "concept_checks": [
    {{
      "question_number": 1,
      "section_tested": "1.1",
      "question_type": "multiple_choice",
      "question_text": "Which organelle is the primary site of ATP production?",
      "options": [
        {{"letter": "A", "text": "Nucleus"}},
        {{"letter": "B", "text": "Mitochondria"}},
        {{"letter": "C", "text": "Golgi apparatus"}},
        {{"letter": "D", "text": "Lysosome"}}
      ],
      "correct_letter": "B",
      "kaplan_explanation": "Mitochondria are the site of the citric acid cycle and oxidative phosphorylation."
    }},
    {{
      "question_number": 2,
      "section_tested": "1.1",
      "question_type": "fill_in_table",
      "question_text": "Complete the following table with the correct organelle functions.",
      "table_headers": ["Organelle", "Function"],
      "table_answers": [
        {{"Organelle": "Lysosome", "Function": "Intracellular digestion of macromolecules"}},
        {{"Organelle": "Peroxisome", "Function": "Breakdown of fatty acids; detoxification"}}
      ]
    }}
  ],

  "equations_to_remember": [
    {{
      "equation_id": "2.1",
      "title": "Kinetic Energy",
      "equation_latex": "K = \\frac{{1}}{{2}}mv^2",
      "equation_plain": "K = (1/2)mv^2",
      "variables": [
        {{"symbol": "K", "meaning": "kinetic energy", "unit": "J"}},
        {{"symbol": "m", "meaning": "mass", "unit": "kg"}},
        {{"symbol": "v", "meaning": "velocity", "unit": "m/s"}}
      ]
    }}
  ],

  "shared_concepts": [
    {{
      "external_book": "Biochemistry",
      "external_chapter": 6,
      "external_chapter_title": "DNA and Biotechnology",
      "topics": ["Energy in biological reactions", "ATP hydrolysis"]
    }}
  ]
}}

═══════════════════════════════════════════════════════════════
CRITICAL EXTRACTION RULES
═══════════════════════════════════════════════════════════════
- Extract text VERBATIM from the book. Do not paraphrase or summarize.
- Every content block MUST have a "format" field from the valid set: text, bullet_list, numbered_steps, comparison_table, fill_in_table, figure_reference, definition
- For tables: capture ALL rows and ALL columns completely. Do not truncate.
- For fill-in concept checks: extract BOTH the blank version AND the filled answers.
- For figure references: record the figure_id and caption exactly as printed.
- If a callout is labeled "MCAT Expertise" or "Mnemonic" or "Bridge" — use the corresponding type tag.
- Do NOT skip any questions. Extract ALL of them with all options.
- Match every question to its correct answer from the answer key section.
- If equations_to_remember or shared_concepts don't exist for this chapter, use empty arrays [].
- Shared concepts: extract exactly as written — the subject, chapter number, chapter title, and listed topics.
